<html>
  <head>
    <title>태양을 찾을태양</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <meta property="og:site_name" content="태양을 찾을태양"/>
    <meta property="og:image" content="http://nupa.fun25.co.kr/p/fts/img/main.jpg">

    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <!-- server -->
    <script>
      var viewRank = function(){
        $.ajax({
          dataType: 'jsonp',
          jsonp: 'callback',
          url: 'http://nupa.fun25.co.kr:17903/view',
          success: function(data) {
            var text = '<table id=rank-table cellspacing=15>';
            text += '<tr>';
            text += '<td> rank </td><td> name </td><td> level </td><td> time </td>';
            text += '</tr>';
            for(var i in data){
              if(i>19) continue;
              var levelName = {
                1:'Debut',
                2:'Regular',
                3:'Pro',
                4:'Master',
                5:'Master+'
              }[data[i].level];
              text += '<tr>';
              text += '<td>' +(i*1+1)+ '</td><td>' + data[i].player +'</td><td>'+ levelName +'</td><td>'+ data[i].time/1000 + 's </td>';
              text += '</tr>';
            }
            text += '</table>';
            $('#rank-container').html(text);
          }
        });
      };
    </script>
    <style>
      .container{
        width: 800px;
      }
      #button-container{
        position: absolute;
        width: 400px;
        height: 50px;
      }
      .button{
        margin: 10px;
        color: #bbb;
        font-size: 20;
        transition: 0.3s;
      }
      .button-disable{
        margin: 10px;
        color: #777;
        font-size: 20;
        cursor: pointer;
      }
      .button:hover {
        color:#fff;
        cursor: pointer;
        font-size: 24;
      }

      #rank-table{
        margin: 20px;
      }
    </style>
  </head>
<body>

<center>
<div class="container">
  <div style="font-size:7pt">
    <p>이 게임은 크롬 및 파이어폭스 최신버전에서 정상작동합니다.</p>
  </div>

  <canvas id="canvas" width=800 height=600></canvas>

  <div id="button-container" style="top:380px;">
    <div class="button">Debut</div>
    <div class="button-disable">Regular</div>
    <div class="button-disable">Pro</div>
    <div class="button-disable">Master</div>
    <div class="button-disable">Master+</div>
  </div>
  <br>
  <br>
  <span style="color:red">랭킹 등록은 Pro난이도부터 가능합니다.</span>
  <div id="rank-container">

  </div>
</div>
<div id="bgm">
  <iframe width="300" height="25" src="http://www.youtube.com/embed/vE8Df0k-mD4?autoplay=1&playlist=vE8Df0k-mD4&loop=1&showinfo=0&fs=0&rel=0" frameborder="0" allowfullscreen></iframe>
</div>
<div style="font-size:7pt">
  <p>이 게임은 학습을 목적으로 개발되었으며 영리적인 목적은 가지고 있지 않습니다. 일부 이미지의 저작권은 '주식회사 반다이남코 엔터테이먼트'에 있습니다.</p>
  <p>このゲームは、学習を目的に開発され、営利的な目的は持っていません。一部の画像の著作権は、「株式会社バンダイナムコエンターテインメント」にあります。</p>
</div>
</center>


</body>


<!-- game -->
<script>
var resource={};resource.tile=new Image,resource.tile.src="img/tile.png",resource.player=new Image,resource.player.src="img/uzuki.png",resource.weed=new Image,resource.weed.src="img/yuko.png",resource.mouse=new Image,resource.mouse.src="img/miria.png",resource.beetle=new Image,resource.beetle.src="img/mayu.png",resource.bg2=new Image,resource.bg2.src="img/background2.png",resource.bg3=new Image,resource.bg3.src="img/background3.png",resource.bg4=new Image,resource.bg4.src="img/background4.png",resource.bg5=new Image,resource.bg5.src="img/background5.png",resource.intro=new Image,resource.intro.src="img/intro.png",resource.bg1=new Image,resource.bg1.src="img/background1.png",resource.ball=new Image,resource.ball.src="img/ball.png",resource.bat=new Image,resource.bat.src="img/mio.png",resource.piece=new Image,resource.piece.src="img/star.png",resource.clear=new Image,resource.clear.src="img/clear.png",function(){this.readySprites={},this.sprites={},this.allSprites={};var e=0,t=10;this.canvas=document.getElementById("canvas"),this.ctx=canvas.getContext("2d"),this.Camera={target:{x:0,y:0,state:"false",moveSpeed:0},marginX:200,marginY:50,x:0,y:0,set:function(e,t){var a,r;if("false"!=Camera.target.state){if(e||t){for(var i in allSprites)"background"!=allSprites[i].tag&&(allSprites[i].x-=e,allSprites[i].y-=t);return Camera.x+=e,void(Camera.y+=t)}if(Camera.target.state.match("rightwalk")){if(a=Math.abs(Camera.target.x-Camera.marginX),r=Math.pow(a/300,3)*(Camera.target.moveSpeed/10),!(100>a)){for(var i in allSprites)"background"!=allSprites[i].tag&&(allSprites[i].x-=r);Camera.x+=r}}else if(Camera.target.state.match("leftwalk")&&(a=Math.abs(Camera.target.x-canvas.width+Camera.marginX),r=Math.pow(a/300,3)*(Camera.target.moveSpeed/10),!(a>700||-100>a))){for(var i in allSprites)"background"!=allSprites[i].tag&&(allSprites[i].x+=r);Camera.x-=r}a=Camera.target.y-canvas.height/2-Camera.marginY,r=10*Math.pow(a/300,3);for(var i in allSprites)"background"!=allSprites[i].tag&&(allSprites[i].y-=r);Camera.y+=r}}};var a=(setInterval(function(){for(var e in readySprites)readySprites[e].x<1100&&(sprites[e]=readySprites[e],delete readySprites[e]);for(var e in sprites)for(var t in sprites[e].updates)sprites[e].updates[t]();Camera.set()},t),function(){ctx.beginPath(),ctx.clearRect(0,0,canvas.width,canvas.height),ctx.fill();for(var e in sprites)for(var t in sprites[e].renderers)sprites[e].renderers[t]();requestAnimationFrame(a)});a(),this.Sprite=function(a){var r={};return r.id=e++,r.tag="default",r.gravity=!1,r["static"]=!1,r.collision=!0,r.width=0,r.height=0,r.x=0,r.y=0,r.ax=0,r.ay=0,r.jump=!0,r.state="right",r.moveSpeed=1,r.starts=[],r.start=function(e){for(var t in r.starts)if(String(r.starts[t])==String(e))return;return r.starts.push(e),r},r.starts.push(function(){r.ani.interval()}),r.updates=[],r.update=function(e){for(var t in r.crashes)if(String(r.updates[t])==String(e))return;return r.updates.push(e),r},r.updates.push(function(){r.x+=r.ax,r.y+=r.ay,r.gravity&&(r.ay+=.2),r.collider(),"player"==r.tag&&(LEFT_ARROW?r.state="leftwalk":"leftwalk"==r.state&&(r.state="left"),RIGHT_ARROW?r.state="rightwalk":"rightwalk"==r.state&&(r.state="right"),UP_ARROW?(r.state="jump",UP_ARROW=!1):"jump"==r.state&&(r.state="nojump")),"leftwalk"==r.state&&(r.x+=-.1*r.moveSpeed),"rightwalk"==r.state&&(r.x+=.1*r.moveSpeed),"jump"!=r.state||r.jump||(BGM.sePlay(4,10),r.ay=-6,r.jump=!0)}),r.renderers=[],r.renderer=function(e){for(var t in r.renderers)if(String(r.renderers[t])==String(e))return;return r.renderers.push(e),r},r.renderers.push(function(){}),r.collider=function(){if(r.collision&&!r["static"])for(var e in sprites)sprites[e].collision&&sprites[e].id!=r.id&&(sprites[e].x>=r.x&&sprites[e].x<r.x+r.width?sprites[e].y>=r.y&&sprites[e].y<r.y+r.height?sprites[e].x+sprites[e].width>=r.x+r.width&&(r.y+r.height-sprites[e].y<r.x+r.width-sprites[e].x+1?(r.emitCrash("bottom",sprites[e]),sprites[e].emitCrash("top",r)):(r.emitCrash("right",sprites[e]),sprites[e].emitCrash("left",r))):r.y>sprites[e].y&&r.y<sprites[e].y+sprites[e].height&&(sprites[e].y+sprites[e].height-r.y<r.x+r.width-sprites[e].x?(r.emitCrash("top",sprites[e]),sprites[e].emitCrash("bottom",r)):(r.emitCrash("right",sprites[e]),sprites[e].emitCrash("left",r))):sprites[e].x<r.x&&r.x<sprites[e].x+sprites[e].width-3&&(sprites[e].y>r.y&&sprites[e].y<r.y+r.height?sprites[e].y-(r.y+r.height)>sprites[e].x-(r.x+r.width)&&(r.y+r.height-sprites[e].y<sprites[e].x+sprites[e].width-r.x?(r.emitCrash("bottom",sprites[e]),sprites[e].emitCrash("top",r)):(r.emitCrash("left",sprites[e]),sprites[e].emitCrash("right",r))):r.y>sprites[e].y&&r.y<sprites[e].y+sprites[e].height&&(sprites[e].y+sprites[e].height-r.y<sprites[e].x+sprites[e].width-r.x?(r.emitCrash("top",sprites[e]),sprites[e].emitCrash("bottom",r)):(r.emitCrash("left",sprites[e]),sprites[e].emitCrash("right",r)))))},r.crashes=[],r.crashes.push(function(e,t){if(!r["static"])switch(e){case"bottom":r.y=t.y-r.height,r.ay=0,r.jump=!1;break;case"top":r.y=t.y+t.height,r.ay=0;break;case"left":r.x=t.x+t.width;break;case"right":r.x=t.x-r.width}}),r.onCrash=function(e){for(var t in r.crashes)if(String(r.crashes[t])==String(e))return;return r.crashes.push(e),r},r.emitCrash=function(e,t){for(var a in r.crashes)r.crashes[a](e,t);return r},r.draw=function(e,t){r.x=e||r.x,r.y=t||r.y;for(var a in r.starts)r.starts[a]();return readySprites[r.id]=r,r},r.deads=[],r.dead=function(){for(var e in r.intervals)clearInterval(r.intervals[e]);for(var t in r.deads)r.deads[t]();return delete sprites[r.id],r},r.onDead=function(e){for(var t in r.deads)if(String(r.deads[t])==String(e))return;return r.deads.push(e),r},r.remove=function(e){return r[e]=[],r},r.ani={img:!1,frame:0,line:0,repeat:!0,interval:function(){}},r.animate=function(e,a,i,n,s,o){return r.ani.img=e,r.ani.interval=function(){r.setInterval(function(){1==r.ani.repeat?(r.ani.frame++,r.ani.frame>=(s||5)&&(r.ani.frame=0)):0==r.ani.repeat&&(r.ani.frame<s&&r.ani.frame++,r.ani.frame>=(s||5)&&(r.ani.frame=s-1))},10*t)},r.renderer(function(){"leftwalk"==r.state&&(r.ani.line=n.leftRun),"left"==r.state&&(r.ani.line=n.left),"rightwalk"==r.state&&(r.ani.line=n.rightRun),"right"==r.state&&(r.ani.line=n.right),!r.jump||r.ani.line!=n.left&&r.ani.line!=n.leftRun?r.jump||r.ani.line!=n.leftJump?!r.jump||r.ani.line!=n.right&&r.ani.line!=n.rightRun?r.jump||r.ani.line!=n.rightJump||(r.ani.line=n.right):r.ani.line=n.rightJump:r.ani.line=n.left:r.ani.line=n.leftJump,"leftbehave"==r.state&&(r.ani.line=n.leftbehave),"rightbehave"==r.state&&(r.ani.line=n.rightbehave),o?(r.ani.x=r.x-o[3],r.ani.y=r.y-o[0],r.ani.width=r.width+o[1]+o[3],r.ani.height=r.height+o[2]+o[0]):(r.ani.x=r.x,r.ani.y=r.y,r.ani.width=r.width,r.ani.height=r.height),ctx.drawImage(r.ani.img,r.ani.frame*a,r.ani.line*i,a,i,r.ani.x,r.ani.y,r.ani.width,r.ani.height)}),r},r.intervals=[],r.setInterval=function(e,t){return r.intervals.push(setInterval(e,t)),r},a(r),allSprites[r.id]=r,r},this.LEFT_ARROW=!1,this.RIGHT_ARROW=!1,this.UP_ARROW=!1,document.body.addEventListener("keydown",function(event){switch(event.keyCode){case 37:LEFT_ARROW=!0,RIGHT_ARROW=!1,event.preventDefault();break;case 38:UP_ARROW=!0,event.preventDefault();break;case 39:RIGHT_ARROW=!0,LEFT_ARROW=!1,event.preventDefault();break;case 40:event.preventDefault()}}),document.body.addEventListener("keyup",function(event){switch(event.keyCode){case 37:LEFT_ARROW=!1;break;case 38:break;case 39:RIGHT_ARROW=!1;break;case 40:}})}(),function(){var e=new Array,t=new Array;this.BGM={},BGM["new"]=function(t,a){e[a]=new Audio(t)},BGM.play=function(t,a,r){e[t].volume=(a||5)/10,e[t].play(),e[t].loop=r||!1},BGM.pause=function(t){e[t].pause()},BGM.stop=function(t){e[t].pause(),e[t].currentTime=0,e[t].volume=1},BGM.control=function(t,a,r){if(10*e[t].volume>a)var i=setInterval(function(){var r=Math.ceil(100*(e[t].volume-=.01));console.log(r),(r-1)/10==a&&(e[t].volume=a/10,clearInterval(i))},r);else if(10*e[t].volume<a)var i=setInterval(function(){var r=Math.ceil(100*(e[t].volume+=.01));console.log(r),r/10==a&&(console.log(r),e[t].volume=a/10,clearInterval(i))},r)},BGM.fadeOut=function(t,a){this.bgm[t]=e[t];var r=setInterval(function(){var a=Math.ceil(100*(e[t].volume-=.01));1==a&&(e[t].volume=0,bgmStop(t),clearInterval(r))},a)},BGM.fadeIn=function(t,a,r,i){this.bgm[t]=e[t],e[t].loop=i,e[t].volume=0,e[t].play();var n=setInterval(function(){var r=Math.ceil(100*(e[t].volume+=.01));r/10==a&&(e[t].volume=a/10,clearInterval(n))},r)},BGM.newSe=function(e,a){t[a]=new Audio(e)},BGM.sePlay=function(e,a){var r=new Audio(t[e].src);r.volume=a/10,r.play()}}();var Weed=function(e,t,a,r,i){var n=a||1,s=r||400,o=i||2e3,h=new Sprite(function(a){a.x=e,a.y=t,a.width=38,a.height=50,a.tag="monster",a.gravity=!0,a.animate(resource.weed,165,235,{left:0,leftRun:1,leftJump:0,right:0,rightRun:2,rightJump:0,leftbehave:3,rightbehave:1},10,[20,10,0,8]),a.ani.repeat=!0,a.remove("crashes"),a.onCrash(function(e,t){if("player"==t.tag&&("top"==e?a.dead():t.dead()),"ball"!=t.tag&&"monster"!=t.tag&&"water"!=t.tag)switch(e){case"bottom":a.y=t.y-a.height,a.ay=0,a.jump=!1;break;case"top":a.y=t.y+t.height,a.ay=0;break;case"right":a.x=t.x-a.width;break;case"left":a.x=t.x+t.width}}),a.start(function(){setTimeout(function(){a.setInterval(function(){var e=Math.abs(h.x-player.x),t=Math.abs(h.y-player.y);if(s>e&&250>t&&sprites[h.id]&&sprites[player.id]){new Sprite(function(e){e.width=16,e.height=16,e.tag="ball",e["static"]=!0;var t=h.x-player.x,a=h.y+h.height/2-(player.y+player.height/2),r=h.state;t>=0&&(h.state="leftbehave"),0>t&&(h.state="rightbehave"),h.ani.repeat=!1,setTimeout(function(){h.state=r,h.ani.repeat=!0},600);var i=Math.sqrt(Math.pow(t,2)+Math.pow(a,2));e.ax=-t/i*n,e.ay=-a/i*n,e.gravity=!1,e.animate(resource.ball,32,32,{left:0,leftRun:0,leftJump:0,right:0,rightRun:0,rightJump:0,leftbehave:0,rightbehave:0},4,[2,2,2,2]),e.remove("crashes"),setTimeout(e.dead,3e3)}).draw(h.x+h.width/4,h.y+h.height/5)}},o)},400)})});return h},Bat=function(e,t,a){var r=new Sprite(function(r){r.x=e,r.y=t,r.width=40,r.height=22,r.moveSpeed=a||10,r.tag="monster",r.jump=!1,r.gravity=!1;var i=!1;r.animate(resource.bat,220,167,{left:0,leftRun:0,leftJump:0,right:0,rightRun:1,rightJump:0},5,[14,8,4,8]),r.start(function(){i=!1,r.x=e,r.y=t,r.setInterval(function(){0==i?r.state="rightwalk":1==i&&(r.state="leftwalk")},100),r.setInterval(function(){0==i?i=!0:1==i&&(i=!1)},1e3)}),r.remove("crashes"),r.onCrash(function(e,t){if("player"==t.tag&&("top"==e?(BGM.sePlay(2,10),r.dead()):t.dead()),"ball"!=t.tag&&"monster"!=t.tag&&"water"!=t.tag)switch(e){case"bottom":r.y=t.y-r.height,r.ay=0,r.jump=!1;break;case"top":r.y=t.y+t.height,r.ay=0;break;case"right":r.x=t.x-r.width;break;case"left":r.x=t.x+t.width}})});return r},Mouse=function(e,t,a,r,i){var n=new Sprite(function(n){n.x=e,n.y=t,n.width=r||30,n.height=i||30,n.moveSpeed=a||10,n.tag="monster",n.gravity=!0,n.ani.repeat=!0;var s=!0;n.update(function(){0==s?n.state="rightwalk":1==s&&(n.state="leftwalk"),n.ay>20&&n.dead()}),n.start(function(){n.x=e,n.y=t,n.ay=0}),n.animate(resource.mouse,137,191,{left:1,leftRun:1,leftJump:1,right:0,rightRun:0,rightJump:0},10,[25,5,0,5]),n.remove("crashes"),n.onCrash(function(e,t){if("player"==t.tag&&("top"==e?n.dead():t.dead()),"water"!=t.tag&&"ball"!=t.tag&&"monster"!=t.tag)switch(e){case"bottom":n.y=t.y-n.height,n.ay=0,n.jump=!1;break;case"top":n.y=t.y+t.height,n.ay=0;break;case"left":n.x=t.x+t.width,s=!1;break;case"right":n.x=t.x-n.width,s=!0}})});return n},Beetle=function(e,t){var a=new Sprite(function(a){a.x=e,a.y=t,a.width=30,a.height=25,a.moveSpeed=3,a.tag="monster",a.state="left",a.gravity=!0;a.start(function(){a.x=e,a.y=t,a.ax=0,a.ay=0}),a.update(function(){var e=Math.abs(a.x-player.x),t=Math.abs(player.y-a.y);400>e&&100>t&&(a.x-player.x>0&&(a.state="leftwalk",a.ax>-3.5&&(a.ax-=.03+e/4e4),!a.jump&&a.ax>-3.1&&a.ax<-3&&(a.ay=-3,a.jump=!0)),a.x-player.x<0&&(a.state="rightwalk",a.ax<3.5&&(a.ax+=.03+e/4e4),!a.jump&&a.ax>3&&a.ax<3.1&&(a.ay=-3,a.jump=!0))),a.ay>20&&a.dead()}),a.animate(resource.beetle,137,191,{left:1,leftRun:1,leftJump:1,right:0,rightRun:0,rightJump:0},9,[30,5,0,5]),a.remove("crashes"),a.onCrash(function(e,t){if("player"==t.tag&&("top"==e?a.dead():t.dead()),"ball"!=t.tag&&"monster"!=t.tag&&"water"!=t.tag)switch(e){case"bottom":a.y=t.y-a.height,a.ay=0,a.jump=!1;break;case"top":a.y=t.y+t.height,a.ay=0;break;case"right":a.x=t.x-a.width,a.ax=0;break;case"left":a.x=t.x+t.width,a.ax=0}})});return a},insertRank=function(e,t,a){$.ajax({dataType:"jsonp",data:'rank={"player":"'+e+'", "level":'+t+', "time":'+a+"}",jsonp:"callback",url:"http://nupa.fun25.co.kr:17903/insert?callback=?",success:function(e){console.log(e)}})},Piece=function(e,t){var a=new Sprite(function(a){a.x=e,a.y=t,a.width=32,a.height=32,a.tag="star",a.gravity=!1;var r=!1;a.update(function(){0==r?a.y-=.3:1==r&&(a.y+=.3)}),a.start(function(){a.setInterval(function(){0==r?r=!0:1==r&&(r=!1)},800)}),a.renderer(function(){ctx.drawImage(resource.piece,a.x,a.y,a.width,a.height)}),a.remove("crashes"),a.onCrash(function(e,t){if("player"==t.tag){a.dead(),BGM.sePlay(5,10),t.havepiece+=1;for(var r in sprites)sprites[r].x<-100&&sprites[r].dead()}if(4==t.havepiece&&(level>clearStage&&(clearStage=level,localStorage.setItem("clearStage",clearStage),localStorage.getItem("clearStage")),t.tag="clear",t.state="jump",a.dead(),new Sprite(function(e){e.width=800,e.height=600,e.collision=!1,e.tag="background",e.alp=0,e.renderer(function(){ctx.save(),ctx.globalAlpha=e.alp+=.01,ctx.drawImage(resource.clear,e.x,e.y,e.width,e.height),ctx.restore()}),e.draw()}),$("#bgm").html(""),BGM.play(2,10,!1),3>level?setTimeout(function(){location.reload()},9e3):setTimeout(function(){var e=prompt({1:"Debut",2:"Regular",3:"Pro",4:"Master",5:"Master+"}[level]+" "+player.time/1e3+"s\n\n이름을 입력해주세요","");insertRank(e,level,player.time),location.reload()},1e3)),"ball"!=t.tag&&"monster"!=t.tag)switch(e){case"bottom":a.y=t.y-a.height,a.ay=0,a.jump=!1;break;case"top":a.y=t.y+t.height,a.ay=0;break;case"right":a.x=t.x-a.width;break;case"left":a.x=t.x+t.width}})});return a},map=[],initMap=function(){var e=new Sprite(function(e){e.width=800,e.height=600,e.collision=!1,e.tag="background",e.alp=1,e.renderer(function(){ctx.save(),ctx.globalAlpha=e.alp,ctx.drawImage(resource.bg1,e.x,e.y,e.width,e.height),ctx.restore()})}),t=new Sprite(function(t){t.width=800,t.height=600,t.collision=!1,t.tag="background",t.alp=0,t.renderer(function(){ctx.save(),t.alp<1.03&&1==player.havepiece&&(e.alp-=1e-4,t.alp+=.01,.3==e.alp&&e.dead()),ctx.globalAlpha=t.alp,ctx.drawImage(resource.bg2,t.x,t.y,t.width,t.height),ctx.restore()})}),a=new Sprite(function(e){e.width=800,e.height=600,e.collision=!1,e.tag="background",e.alp=0,e.renderer(function(){ctx.save(),e.alp<1.03&&2==player.havepiece&&(t.alp-=1e-4,e.alp+=.01,.3==t.alp&&t.dead()),ctx.globalAlpha=e.alp,ctx.drawImage(resource.bg3,e.x,e.y,e.width,e.height),ctx.restore()})}),r=new Sprite(function(e){e.width=800,e.height=600,e.collision=!1,e.tag="background",e.alp=0,e.renderer(function(){ctx.save(),e.alp<1.03&&3==player.havepiece&&(a.alp-=1e-4,e.alp+=.01,.3==a.alp&&a.dead()),ctx.globalAlpha=e.alp,ctx.drawImage(resource.bg4,e.x,e.y,e.width,e.height),ctx.restore()})}),i=new Sprite(function(e){e.width=800,e.height=600,e.collision=!1,e.tag="background",e.alp=0,e.renderer(function(){ctx.save(),e.alp<1.03&&4==player.havepiece&&(i.alp-=1e-4,e.alp+=.01,.3==i.alp&&i.dead()),ctx.globalAlpha=e.alp,ctx.drawImage(resource.bg5,e.x,e.y,e.width,e.height),ctx.restore()})}),n=function(){return new Sprite(function(e){e.width=50,e.height=50,e["static"]=!0,e.renderer(function(){ctx.drawImage(resource.tile,196,392,196,196,e.x,e.y,e.width,e.height)})})},s=function(){return new Sprite(function(e){e.width=50,e.height=50,e["static"]=!0,e.renderer(function(){ctx.drawImage(resource.tile,196,588,196,196,e.x,e.y,e.width,e.height)})})},o=function(){return new Sprite(function(e){e.width=50,e.height=20,e.tag="branch",e["static"]=!0,e.renderer(function(){ctx.drawImage(resource.tile,196,588,196,196,e.x,e.y,e.width,e.height)})})},h=function(){return new Sprite(function(e){e.width=50,e.height=50,e["static"]=!0,e.renderer(function(){ctx.drawImage(resource.tile,0,392,196,196,e.x,e.y,e.width,e.height)})})},l=function(){var e,t;return new Sprite(function(a){a.width=100,a.height=40,a.moveSpeed=10,a.state="left",a.jump=!1,a["static"]=!0,a.gravity=!1;var r=!1,i=0;a.animate(resource.bat,220,167,{left:0,leftRun:0,leftJump:0,right:0,rightRun:1,rightJump:0},5,[40,5,5,5]),a.start(function(){e||(e=a.x,t=a.y),a.x=e,a.y=t,a.state="left",r=!1}),a.update(function(){i++,100==i&&(0==r?r=!0:1==r&&(r=!1),i=0),0==r?a.state="rightwalk":1==r&&(a.state="leftwalk")}),a.remove("crashes"),a.onCrash(function(e,t){if("player"==t.tag&&"top"==e&&("leftwalk"==a.state?t.x+=-.2*a.moveSpeed:t.x+=.2*a.moveSpeed),"ball"!=t.tag)switch(e){case"bottom":a.y=t.y-a.height,a.ay=0,a.jump=!1;break;case"top":a.y=t.y+t.height,a.ay=0;break;case"right":a.x=t.x-a.width;break;case"left":a.x=t.x+t.width}})})},u=function(){return new Sprite(function(e){e.width=50,e.height=50,e.collision=!1,e["static"]=!0,e.renderer(function(){ctx.drawImage(resource.tile,392,588,196,196,e.x,e.y,e.width,e.height)})})},d=function(e,t){return new Sprite(function(a){a.width=e,a.height=t,a.tag="water",a["static"]=!0,a.remove("crashes")})},c=function(e,t,a,r){for(var i=0;t>i;i++){var n=e();"right"==a?map.push(n.draw(r.x+(i*n.width+i*(r.d||0)),r.y)):"left"==a?map.push(n.draw(r.x-(i*n.width+i*(r.d||0)),r.y)):"down"==a?map.push(n.draw(r.x,r.y+(i*n.height+i*(r.d||0)))):"up"==a&&map.push(n.draw(r.x,r.y-(i*n.height+i*(r.d||0))))}};map.push(e),map.push(t),map.push(a),map.push(r),map.push(i),c(n,5,"right",{x:0,y:450}),c(n,10,"right",{x:250,y:500}),c(n,12,"right",{x:750,y:450}),c(n,7,"right",{x:1350,y:500}),c(n,6,"right",{x:1700,y:475}),c(n,10,"right",{x:2e3,y:425}),c(n,8,"right",{x:2500,y:375}),c(n,8,"right",{x:2900,y:350}),c(s,4,"down",{x:3250,y:400}),c(n,5,"right",{x:3300,y:550}),c(n,4,"right",{x:3500,y:525}),c(o,3,"up",{x:3650,y:470,d:80}),c(s,6,"up",{x:3700,y:525}),c(n,8,"right",{x:3700,y:225}),c(s,6,"up",{x:4050,y:525}),c(o,3,"up",{x:4100,y:470,d:80}),c(n,8,"right",{x:4100,y:525}),c(s,15,"up",{x:4275,y:370}),c(o,2,"up",{x:4225,y:400,d:80}),c(o,2,"up",{x:4325,y:400,d:80}),c(s,6,"up",{x:4500,y:525}),c(o,3,"up",{x:4450,y:470,d:80}),c(n,8,"right",{x:4500,y:225}),c(s,6,"up",{x:4800,y:525}),c(n,5,"right",{x:4850,y:525}),c(n,5,"right",{x:5100,y:475}),c(n,5,"right",{x:5350,y:425}),c(n,6,"right",{x:5600,y:375}),c(n,6,"right",{x:5e3,y:225,d:100}),c(s,4,"up",{x:5900,y:375}),c(o,2,"up",{x:5850,y:310,d:65}),c(h,5,"right",{x:5950,y:225}),c(l,2,"right",{x:6250,y:225,d:100}),c(l,2,"right",{x:6370,y:425,d:100}),c(l,1,"right",{x:6700,y:610,d:100}),c(h,4,"right",{x:6700,y:225}),c(h,4,"right",{x:6900,y:250}),c(h,5,"right",{x:7100,y:200}),c(h,7,"right",{x:7350,y:225}),c(h,11,"up",{x:7700,y:225}),c(h,10,"right",{x:6800,y:800}),c(h,4,"right",{x:7150,y:350}),c(h,8,"right",{x:7300,y:750}),c(h,7,"down",{x:7700,y:275}),c(h,7,"right",{x:7750,y:750}),c(h,5,"up",{x:8100,y:750,d:110}),c(o,5,"up",{x:8200,y:670,d:140}),c(h,3,"up",{x:8400,y:750,d:110}),c(h,3,"up",{x:8450,y:750,d:110}),c(h,8,"right",{x:8300,y:100}),c(h,10,"right",{x:8700,y:150}),map.push(new d(500,50).draw(8700,101)),c(u,10,"right",{x:8700,y:100}),c(h,10,"right",{x:9200,y:100}),c(h,12,"down",{x:9200,y:150}),c(h,15,"up",{x:9800,y:300}),c(h,8,"left",{x:9750,y:300}),c(h,14,"right",{x:9200,y:750}),map.push(new d(600,150).draw(9250,601)),c(u,12,"right",{x:9250,y:700}),c(u,10,"right",{x:9250,y:650}),c(u,10,"right",{x:9250,y:600}),c(h,4,"up",{x:9750,y:650}),c(h,6,"right",{x:9800,y:500}),c(l,1,"right",{x:10150,y:500}),c(h,2,"right",{x:10400,y:500}),c(h,1,"up",{x:9850,y:700})},renderMap=function(){map[1].alp=0,map[2].alp=0,map[3].alp=0,map[4].alp=0;for(var e in map)map[e].draw()},clearStage=0,level;BGM["new"]("bgm/ganba.mp3",1),BGM["new"]("bgm/ending.mp3",2),BGM.newSe("bgm/shot.mp3",1),BGM.newSe("bgm/yameru.mp3",2),BGM.newSe("bgm/nice.mp3",3),BGM.newSe("bgm/jump.mp3",4),BGM.newSe("bgm/star.mp3",5),initMap();var debut=[new Piece(3250,330),new Piece(5940,200),new Piece(8300,50),new Piece(10450,450),new Weed(1600,300),new Mouse(400+600*Math.random(),300,10+10*Math.random()),new Weed(2300,300),new Beetle(4400+50*Math.random(),400),new Weed(7200,100),new Bat(8e3+300*Math.random(),650+50*Math.random()),new Weed(9300,50),new Mouse(9300+200*Math.random(),300,5+10*Math.random())],regular=[new Mouse(700+600*Math.random(),300,10+10*Math.random()),new Mouse(4200+100*Math.random(),400,10+10*Math.random()),new Beetle(5200+500*Math.random(),200),new Mouse(7100+400*Math.random(),100,10+10*Math.random()),new Weed(7900,600),new Beetle(9e3+400*Math.random(),50),new Weed(9500,300,1.5)],pro=[new Weed(600,300),new Mouse(800+300*Math.random(),300,10+10*Math.random()),new Mouse(1e3+600*Math.random(),300,10+10*Math.random()),new Bat(1400+50*Math.random(),400),new Beetle(1600+500*Math.random(),200),new Beetle(2e3+300*Math.random(),200),new Mouse(2400+400*Math.random(),200,12+10*Math.random()),new Beetle(2800+300*Math.random(),300),new Bat(3300+200*Math.random(),375),new Weed(5500,200,2,500),new Beetle(6e3+100*Math.random(),300),new Weed(6500,150,2,500,1800),new Weed(7500,600),new Beetle(8e3+200*Math.random(),400),new Weed(8400,400,2.5),new Mouse(9100+400*Math.random(),100,10+10*Math.random()),new Mouse(9300+100*Math.random(),300,5+10*Math.random())],master=[new Mouse(1e3,300,10+10*Math.random()),new Beetle(800+400*Math.random(),300),new Beetle(2300+400*Math.random(),300),new Weed(3e3,300),new Mouse(2100+500*Math.random(),200,13+10*Math.random()),new Beetle(3e3+500*Math.random(),300),new Beetle(3500+200*Math.random(),300),new Weed(3850,200,1,500),new Weed(4700,200,1,500,1800),new Bat(4350+50*Math.random(),350),new Weed(4400,400,1.2,500),new Beetle(4600+200*Math.random(),100),new Weed(5200,200,2,500),new Beetle(5100+200*Math.random(),100),new Mouse(5100+100*Math.random(),100,13+10*Math.random()),new Weed(5150,100,1.5,500,1800),new Weed(7700,100,1.5,500,1800),new Bat(6500,300),new Beetle(7400+500*Math.random(),600),new Beetle(7800,600),new Weed(8400,550,2,500,1700),new Beetle(8500+200*Math.random(),50),new Beetle(8900+200*Math.random(),100),new Weed(9e3,100,2,500,1800),new Mouse(9100+400*Math.random(),100,13+10*Math.random()),new Mouse(9100+400*Math.random(),100,13+10*Math.random()),new Beetle(9400+300*Math.random(),200),new Weed(9700,300,2,500,1800)],master2=[new Weed(400,300,1.2,500),new Mouse(300+600*Math.random(),300,15+10*Math.random()),new Weed(2600,200,1.5,500,1800),new Beetle(1500+500*Math.random(),600),new Bat(2300+100*Math.random(),300+50*Math.random()),new Beetle(2500+800*Math.random(),600),new Mouse(3200+600*Math.random(),200,15+10*Math.random()),new Weed(3500,200,1.2,500,1700),new Beetle(4600,600),new Weed(5450,200,2,600,1700),new Weed(5700,200,2,500),new Mouse(5400+400*Math.random(),200,15+10*Math.random()),new Beetle(5500+300*Math.random(),300),new Beetle(6200+500*Math.random(),600),new Weed(6750,150,1,500),new Mouse(7400+300*Math.random(),100,12+10*Math.random()),new Beetle(7400+400*Math.random(),100),new Beetle(7700+300*Math.random(),600),new Bat(7300+100*Math.random(),650+30*Math.random()),new Weed(8400,650,2.5,500),new Bat(8600+100*Math.random(),10+20*Math.random()),new Mouse(9100+600*Math.random(),100,12+10*Math.random()),new Mouse(9200+500*Math.random(),100,15+10*Math.random()),new Weed(8900,100,1.2,500),new Beetle(9200+300*Math.random(),100),new Weed(9600,200,2,500,1800),new Weed(9300,500,2,500),new Beetle(9600+300*Math.random(),400),new Beetle(1e4,300),new Weed(10400,200,1.5,500)],player=new Sprite(function(e){e.width=20,e.height=60,e.gravity=!0,e.tag="player",e.moveSpeed=20,e.death=0,e.time=0,e.start(function(){e.havepiece=0}),e.animate(resource.player,133,191,{left:2,leftRun:3,leftJump:5,right:0,rightRun:1,rightJump:4},8,[10,15,0,15]),e.update(function(){e.time+=10,e.ay>20&&e.dead()}),e.onDead(function(){BGM.sePlay(3,10),e.death++,e.ay=0,e.time=0,setTimeout(function(){gameStart(level)},100)}),e.remove("crashes"),e.onCrash(function(t,a){if("water"==a.tag)return e.x-=.45,e.ay>1?e.ay-=.2:e.ay<-1&&(e.ay+=.2),void(e.jump=!1);if("ball"==a.tag)return void e.dead();if("branch"==a.tag)"bottom"==t&&e.ay>0&&e.y+e.height<a.y+10&&(e.y=a.y-e.height,e.ay=0,e.jump=!1,setTimeout(function(){a.dead()},1e3),setTimeout(function(){a.draw()},3e3));else switch(t){case"bottom":e.y=a.y-e.height,e.ay=0,"star"==a.tag?e.jump=!0:"monster"==a.tag?(BGM.sePlay(1,5),e.jump=!0,e.ay=-3):e.jump=!1;break;case"top":e.y=a.y+a.height,e.ay=0;break;case"right":e.x=a.x-e.width;break;case"left":e.x=a.x+a.width}})}),gameStart=function(e){Camera.set(-Camera.x,-Camera.y),level=e||1;for(var t in allSprites)"player"!=allSprites[t].tag&&allSprites[t].dead();renderMap(),player.draw(100,200),Camera.target=player,setTimeout(function(){BGM.play(1,10,!1)},500);for(var t in debut)debut[t].draw();if(1!=level)for(var t in regular)regular[t].draw();if(1!=level&&2!=level)for(var t in pro)pro[t].draw();if(1!=level&&2!=level&&3!=level)for(var t in master)master[t].draw();if(1!=level&&2!=level&&3!=level&&4!=level)for(var t in master2)master2[t].draw()};clearStage=localStorage.getItem("clearStage")||1,viewRank();for(var i=0;clearStage>i;i++)$(".button-disable")[0]&&($(".button-disable")[0].className="button");var intro=new Sprite(function(e){e.width=800,e.height=600,e.collision=!1,e.tag="background",e.renderer(function(){ctx.font="30px Arial",ctx.fillText("Loading...",10,50),ctx.drawImage(resource.bg1,e.x,e.y,e.width,e.height),ctx.drawImage(resource.intro,e.x,e.y,e.width,e.height)}),e.draw(0,0)});$(".button").click(function(){var e={Debut:1,Regular:2,Pro:3,Master:4,"Master+":5}[$(this).text()];$("#button-container").hide(),intro.dead(),gameStart(e),$("#bgm>iframe").prop('src','http://www.youtube.com/embed/zBgy4lrOdt4?autoplay=1&playlist=zBgy4lrOdt4&loop=1&showinfo=0&fs=0&rel=0')});
</script>

</html>
